<h1>Chat rooms</h1>

<p class="lead"><%= link_to 'New chat room', new_chat_room_path, class: 'btn btn-primary' %></p>

<ul>
  <%= render @chat_rooms %>
</ul>

<div id="map" style="width:750px;height:350px;"></div>

	<script src="//dapi.kakao.com/v2/maps/sdk.js?appkey=c6ea41f666279e7bdb879ad0abc158b7"></script>
	<script>
		var mapContainer = document.getElementById('map'), // 지도를 표시할 div
		    mapOption = {
		        center: new daum.maps.LatLng(37.551552015763484, 127.6123687781394), // 지도의 중심좌표
		        level: 14, // 지도의 확대 레벨
		        mapTypeId : daum.maps.MapTypeId.ROADMAP // 지도종류
		    };

		// 지도를 생성한다
		var map = new daum.maps.Map(mapContainer, mapOption);

    <% @chat_rooms.each do |chat_room| %>
      var markerPosition  = new daum.maps.LatLng(<%= chat_room.lat %>, <%= chat_room.lng %>);

      // 마커를 생성합니다
      var marker = new daum.maps.Marker({
          position: markerPosition
      });

      // 마커가 지도 위에 표시되도록 설정합니다
      marker.setMap(map);

      daum.maps.event.addListener(marker, 'click', function() {
            // 마커 위에 인포윈도우를 표시합니다
            window.location.href = '/chat_rooms/<%= chat_room.id %>';
      });

    <% end %>
	</script>
